<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1168px" preserveAspectRatio="none" style="width:974px;height:1168px;background:#FFFFFF;" version="1.1" viewBox="0 0 974 1168" width="974px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="222.0625" style="stroke:#000000;stroke-width:1.5;" width="734.5" x="83" y="819.0781"/><rect fill="none" height="59.2656" style="stroke:#000000;stroke-width:1.5;" width="328.5" x="372" y="945.7422"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="115" x2="115" y1="81.2969" y2="1087.2734"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="436" x2="436" y1="81.2969" y2="1087.2734"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="740.5" x2="740.5" y1="81.2969" y2="1087.2734"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="93" y="77.9951">Client</text><ellipse cx="115.5" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M115.5,21.5 L115.5,48.5 M102.5,29.5 L128.5,29.5 M115.5,48.5 L102.5,63.5 M115.5,48.5 L128.5,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="93" y="1099.2686">Client</text><ellipse cx="115.5" cy="1111.0703" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M115.5,1119.0703 L115.5,1146.0703 M102.5,1127.0703 L128.5,1127.0703 M115.5,1146.0703 L102.5,1161.0703 M115.5,1146.0703 L128.5,1161.0703 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109" x="382" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="389" y="69.9951">Storage Node</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109" x="382" y="1086.2734"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="389" y="1106.2686">Storage Node</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="673.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="680.5" y="69.9951">Consensus Node</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="673.5" y="1086.2734"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="680.5" y="1106.2686">Consensus Node</text><line style="stroke:#181818;stroke-width:1.0;" x1="115.5" x2="157.5" y1="142.6953" y2="142.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="157.5" x2="157.5" y1="142.6953" y2="155.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="116.5" x2="157.5" y1="155.6953" y2="155.6953"/><polygon fill="#181818" points="126.5,151.6953,116.5,155.6953,126.5,159.6953,122.5,155.6953" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="122.5" y="107.3638">1.split file, insufficient padding 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="122.5" y="122.4966">2.redundant processing</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="122.5" y="137.6294">3.generate metadata</text><path d="M5,168.6953 L5,435.6953 L226,435.6953 L226,178.6953 L216,168.6953 L5,168.6953 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M216,168.6953 L216,178.6953 L226,178.6953 L216,168.6953 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="80" x="11" y="185.7622">metadata={</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="104" x="43" y="200.895">fileSize: xxx</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="104" x="43" y="216.0278">fileHash: xxx</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="128" x="43" y="231.1606">segmentSize: xxx</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="101" x="43" y="246.2935">userBrief：[{</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="72" x="75" y="261.4263">user:xxx,</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="104" x="75" y="276.5591">fileName:xxx,</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="120" x="75" y="291.6919">bucketName:xxx,</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="48" x="43" y="306.8247">},...]</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="120" x="43" y="321.9575">segmentList: [{</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="136" x="75" y="337.0903">segmentHash: xxx,</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="128" x="75" y="352.2231">fragmentList: [{</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="72" x="107" y="367.356">hash:xxx,</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="80" x="107" y="382.4888">miner:xxx,</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="48" x="75" y="397.6216">},...]</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="56" x="43" y="412.7544">}, ...]</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="8" x="11" y="427.8872">}</text><polygon fill="#181818" points="728.5,458.0859,738.5,462.0859,728.5,466.0859,732.5,462.0859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="115.5" x2="734.5" y1="462.0859" y2="462.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="122.5" y="457.02">DeclareFileUpload(metadata)</text><line style="stroke:#181818;stroke-width:1.0;" x1="740.5" x2="782.5" y1="491.2188" y2="491.2188"/><line style="stroke:#181818;stroke-width:1.0;" x1="782.5" x2="782.5" y1="491.2188" y2="504.2188"/><line style="stroke:#181818;stroke-width:1.0;" x1="741.5" x2="782.5" y1="504.2188" y2="504.2188"/><polygon fill="#181818" points="751.5,500.2188,741.5,504.2188,751.5,508.2188,747.5,504.2188" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="747.5" y="486.1528">Validate metadata</text><line style="stroke:#181818;stroke-width:1.0;" x1="740.5" x2="782.5" y1="533.3516" y2="533.3516"/><line style="stroke:#181818;stroke-width:1.0;" x1="782.5" x2="782.5" y1="533.3516" y2="546.3516"/><line style="stroke:#181818;stroke-width:1.0;" x1="741.5" x2="782.5" y1="546.3516" y2="546.3516"/><polygon fill="#181818" points="751.5,542.3516,741.5,546.3516,751.5,550.3516,747.5,546.3516" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183" x="747.5" y="528.2856">Generate uploaded file order</text><line style="stroke:#181818;stroke-width:1.0;" x1="740.5" x2="782.5" y1="575.4844" y2="575.4844"/><line style="stroke:#181818;stroke-width:1.0;" x1="782.5" x2="782.5" y1="575.4844" y2="588.4844"/><line style="stroke:#181818;stroke-width:1.0;" x1="741.5" x2="782.5" y1="588.4844" y2="588.4844"/><polygon fill="#181818" points="751.5,584.4844,741.5,588.4844,751.5,592.4844,747.5,588.4844" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="220" x="747.5" y="570.4185">Assign storage nodes to this order</text><path d="M566,601.4844 L566,777.4844 L915,777.4844 L915,611.4844 L905,601.4844 L566,601.4844 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M905,601.4844 L905,611.4844 L915,611.4844 L905,601.4844 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="64" x="572" y="618.5513">result={</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="136" x="604" y="633.6841">fragmentAllocs:[{</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="72" x="668" y="648.8169">hash:xxx,</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="232" x="668" y="663.9497">miner: storage node account1,</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="16" x="636" y="679.0825">},</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="8" x="636" y="694.2153">{</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="72" x="668" y="709.3481">hash:xxx,</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="232" x="668" y="724.481">miner: storage node account2,</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="48" x="636" y="739.6138">},...]</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="232" x="604" y="754.7466">expirationTime: &lt;BlockHeight&gt;</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="8" x="572" y="769.8794">}</text><polygon fill="#181818" points="126.5,800.0781,116.5,804.0781,126.5,808.0781,122.5,804.0781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="120.5" x2="739.5" y1="804.0781" y2="804.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="132.5" y="799.0122">success, raise event</text><path d="M83,819.0781 L160,819.0781 L160,826.2109 L150,836.2109 L83,836.2109 L83,819.0781 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="222.0625" style="stroke:#000000;stroke-width:1.5;" width="734.5" x="83" y="819.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="98" y="832.145">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="134" x="175" y="831.2886">[each fragmentAlloc]</text><polygon fill="#181818" points="424.5,853.3438,434.5,857.3438,424.5,861.3438,428.5,857.3438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="115.5" x2="430.5" y1="857.3438" y2="857.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="297" x="122.5" y="852.2778">pushFragments(storageTaskId, fragmentData)</text><polygon fill="#181818" points="728.5,897.6094,738.5,901.6094,728.5,905.6094,732.5,901.6094" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="436.5" x2="734.5" y1="901.6094" y2="901.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="443.5" y="881.4106">check storage task,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="280" x="443.5" y="896.5435">ensure each fragment if in self pending pool</text><polygon fill="#181818" points="447.5,926.7422,437.5,930.7422,447.5,934.7422,443.5,930.7422" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="441.5" x2="739.5" y1="930.7422" y2="930.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="453.5" y="925.6763">ok to continue</text><path d="M372,945.7422 L449,945.7422 L449,952.875 L439,962.875 L372,962.875 L372,945.7422 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="59.2656" style="stroke:#000000;stroke-width:1.5;" width="328.5" x="372" y="945.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="387" y="958.8091">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="103" x="464" y="957.9526">[each fragment]</text><line style="stroke:#181818;stroke-width:1.0;" x1="436.5" x2="478.5" y1="984.0078" y2="984.0078"/><line style="stroke:#181818;stroke-width:1.0;" x1="478.5" x2="478.5" y1="984.0078" y2="997.0078"/><line style="stroke:#181818;stroke-width:1.0;" x1="437.5" x2="478.5" y1="997.0078" y2="997.0078"/><polygon fill="#181818" points="447.5,993.0078,437.5,997.0078,447.5,1001.0078,443.5,997.0078" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245" x="443.5" y="978.9419">store the fragment temporary on local</text><polygon fill="#181818" points="126.5,1029.1406,116.5,1033.1406,126.5,1037.1406,122.5,1033.1406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="120.5" x2="435.5" y1="1033.1406" y2="1033.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="132.5" y="1028.0747">each fragment stored</text><polygon fill="#181818" points="728.5,1065.2734,738.5,1069.2734,728.5,1073.2734,732.5,1069.2734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="436.5" x2="734.5" y1="1069.2734" y2="1069.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225" x="443.5" y="1064.2075">report fragments temporary stored</text></g></svg>